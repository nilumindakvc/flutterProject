# Firebase Setup Instructions

## Firebase Integration Completed ‚úÖ

Your Flutter app has been successfully integrated with Firebase Authentication! Here's what has been implemented:

### ‚úÖ What's Already Done:

1. **Dependencies Added**
   - firebase_core
   - firebase_auth
   - cloud_firestore

2. **Authentication Service Created**
   - Sign in with email/password
   - Registration with email/password
   - Password reset
   - Sign out functionality
   - User data storage in Firestore

3. **Login Page Updated**
   - Firebase authentication integration
   - Loading states
   - Error handling
   - Forgot password functionality

4. **Registration Page Updated**
   - Firebase registration
   - Password validation
   - Terms agreement check
   - User profile creation

5. **Home Page Updated**
   - Firebase logout integration
   - Automatic VPN disconnect on logout

---

## üîß Required: Firebase Project Configuration

To complete the setup, you need to configure your Firebase project:

### Step 1: Create Firebase Project

1. Go to [Firebase Console](https://console.firebase.google.com/)
2. Click "Add project" or select an existing project
3. Follow the setup wizard

### Step 2: Enable Authentication

1. In Firebase Console, go to **Authentication** > **Sign-in method**
2. Enable **Email/Password** authentication
3. Save changes

### Step 3: Create Firestore Database

1. Go to **Firestore Database** in Firebase Console
2. Click "Create database"
3. Start in **test mode** (you can update security rules later)
4. Choose a location closest to your users

### Step 4: Install Firebase CLI

```bash
# Install Firebase CLI
npm install -g firebase-tools

# Or using curl
curl -sL https://firebase.tools | bash
```

### Step 5: Configure Flutter App

```bash
# Login to Firebase
firebase login

# Install FlutterFire CLI
dart pub global activate flutterfire_cli

# Configure your Flutter app with Firebase
flutterfire configure
```

When running `flutterfire configure`:

- Select your Firebase project
- Choose the platforms you want (iOS, Android, Web, macOS)
- This will create the `firebase_options.dart` file automatically

### Step 6: Update main.dart

After running `flutterfire configure`, update your `main.dart`:

```dart
import 'package:flutter/material.dart';
import 'package:firebase_core/firebase_core.dart';
import 'firebase_options.dart'; // This file is generated by flutterfire configure
import 'package:vpn/theme/app_colors.dart';
import 'package:vpn/widget_tree.dart';

void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  runApp(const MyApp());
}
```

### Step 7: Platform-Specific Configuration

#### Android Configuration

1. Open `android/app/build.gradle`
2. Ensure minSdkVersion is at least 21:
   ```gradle
   defaultConfig {
       minSdkVersion 21  // or higher
       ...
   }
   ```

#### iOS Configuration

1. Open `ios/Podfile`
2. Ensure platform version is at least 13.0:

   ```ruby
   platform :ios, '13.0'
   ```

3. Run:
   ```bash
   cd ios && pod install && cd ..
   ```

---

## üß™ Testing Your Setup

### Test Registration:

1. Run your app
2. Navigate to Registration page
3. Enter:
   - Username: testuser
   - Email: test@example.com
   - Password: test123456
   - Confirm password: test123456
4. Check "I agree to terms"
5. Click "Create Account"

### Test Login:

1. Navigate to Login page
2. Enter registered email and password
3. Click "Sign In"

### Test Logout:

1. On Home page, click the logout button (top-right red icon)
2. Confirm logout in the dialog

---

## üîí Security Rules (Recommended)

After testing, update your Firestore security rules:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Users collection
    match /users/{userId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
```

---

## üì± Features Implemented

### Authentication Features:

- ‚úÖ Email/Password Registration
- ‚úÖ Email/Password Login
- ‚úÖ Password Reset (Forgot Password)
- ‚úÖ User Profile Storage in Firestore
- ‚úÖ Logout with VPN disconnect
- ‚úÖ Form Validation
- ‚úÖ Error Handling
- ‚úÖ Loading States

### User Data Stored:

- Username
- Email
- User ID
- Account creation timestamp

---

## üöÄ Next Steps

1. Run `flutterfire configure` to generate Firebase config
2. Update `main.dart` with the generated `firebase_options.dart`
3. Test registration and login
4. Update Firestore security rules
5. Consider adding:
   - Email verification
   - Profile picture upload
   - Social authentication (Google, Apple, etc.)
   - Two-factor authentication

---

## üìö Additional Resources

- [Firebase Console](https://console.firebase.google.com/)
- [FlutterFire Documentation](https://firebase.flutter.dev/)
- [Firebase Authentication Documentation](https://firebase.google.com/docs/auth)
- [Firestore Documentation](https://firebase.google.com/docs/firestore)

---

## ‚ö†Ô∏è Important Notes

1. **Never commit your `google-services.json` (Android) or `GoogleService-Info.plist` (iOS) to public repositories**
2. Add them to `.gitignore` if needed
3. Use Firebase App Check for production apps
4. Implement proper security rules before production deployment
5. Consider implementing email verification for new users

---

## üêõ Troubleshooting

### Common Issues:

**Issue: "Firebase not initialized"**

- Solution: Make sure you ran `flutterfire configure` and imported `firebase_options.dart`

**Issue: "PlatformException"**

- Solution: Check that you've added the platform-specific configuration files

**Issue: "Invalid API key"**

- Solution: Re-run `flutterfire configure` to regenerate config files

**Issue: "Email already in use"**

- Solution: This is expected if trying to register with an existing email

---

For more help, check the Firebase Console logs or the Flutter debug console for detailed error messages.
